<VirtualHost *:80>
	ServerName io500.vi4io.org

	Redirect permanent / https://io500.vi4io.org/

	<Directory />
		Options SymLinksIfOwnerMatch
		AllowOverride None
		Require all denied
	</Directory>

	ErrorLog ${APACHE_LOG_DIR}/error-io500.log
	LogLevel warn
	CustomLog ${APACHE_LOG_DIR}/access-io500.log combined
</VirtualHost>


<IfModule mod_ssl.c>
<VirtualHost _default_:443>
	ServerAdmin admin@io500.vi4io.org
	ServerName io500.vi4io.org

	DocumentRoot /home/www/io-500-webpage/data/_site

	<Directory />
		Options SymLinksIfOwnerMatch
		AllowOverride None
		Require all denied
	</Directory>
	<Directory /home/www/io-500-webpage/data/_site>
		Options ExecCGI IncludesNOEXEC SymLinksIfOwnerMatch
		AllowOverride AuthConfig FileInfo Indexes Limit Options=ExecCGI,IncludesNOEXEC,Indexes,MultiViews,SymLinksIfOwnerMatch
		Require all granted
	</Directory>


	ErrorLog ${APACHE_LOG_DIR}/error-io500-cert.log
	LogLevel warn
	CustomLog ${APACHE_LOG_DIR}/access-io500-cert.log combined

	SSLEngine on
	<FilesMatch "\.(cgi|shtml|phtml|php)$">
		SSLOptions +StdEnvVars
	</FilesMatch>
	<Directory /usr/lib/cgi-bin>
		SSLOptions +StdEnvVars
	</Directory>

	Include /etc/letsencrypt/options-ssl-apache.conf
	SSLCertificateFile /etc/letsencrypt/live/io500.vi4io.org/fullchain.pem
	SSLCertificateKeyFile /etc/letsencrypt/live/io500.vi4io.org/privkey.pem

	ScriptAlias /stats /usr/lib/cgi-bin
	RewriteEngine on
	RewriteRule ^/stats/$ "/www-stats/awstats.pl?config=io500.vi4io.org" [R=permanent,L]
</VirtualHost>
</IfModule>

